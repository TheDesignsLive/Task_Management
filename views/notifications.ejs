<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Notifications</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#3C3A3A;
}

.layout{
  display:flex;
  min-height:calc(100vh - 60px);
}

.sidebar-container{
  width:55px;
}

.main-content{
  flex:1;
  padding:20px;
  background:#f4f4f4;
}

.box{
  background:white;
  padding:20px;
  border-radius:8px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}

th, td{
  border:1px solid #ccc;
  padding:10px;
  text-align:center;
}

th{
  background:#CDF4F4;
}

.action-btn{
  padding:6px 10px;
  border:none;
  cursor:pointer;
  border-radius:4px;
  font-weight:bold;
}

.accept-btn{
  background:#2ecc71;
  color:white;
}

.reject-btn{
  background:#e74c3c;
  color:white;
}
</style>
</head>

<body>

<!-- ===== NAVBAR ===== -->
<%- include('navbar') %>

<div class="layout">

  <!-- ===== SIDEBAR ===== -->
  <div class="sidebar-container">
    <% if (show_sidebar === 'sidebar') { %>
        <%- include('sidebar') %>
    <% } else { %>
        <%- include('user_sidebar') %>
    <% } %>
  </div>

  <!-- ===== MAIN CONTENT ===== -->
  <div class="main-content">

    <div class="box">
      <h2>Notifications</h2>

      <% if (session.role === 'admin' && memberRequests.length > 0) { %>

        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Profile</th>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Role</th>
              <th>Requested By</th>
              <th>Date</th>
              <th>ACTION</th>
            </tr>
          </thead>

          <tbody>
            <% memberRequests.forEach((r, i) => { %>
              <tr>
                <td><%= i + 1 %></td>

                <td>
                  <% if (r.profile_pic) { %>
                    <img src="<%= r.profile_pic %>" width="40" height="40" style="border-radius:50%;">
                  <% } else { %>
                    N/A
                  <% } %>
                </td>

                <td><%= r.name %></td>
                <td><%= r.email %></td>
                <td><%= r.phone || 'N/A' %></td>
                <td><%= r.role_name %></td>
                <td><%= r.requested_by_name %></td>
                <td><%= new Date(r.created_at).toLocaleDateString() %></td>

                <td>
                  <button class="action-btn accept-btn"
                    onclick="location.href='/approve-member/<%= r.id %>'">
                    Accept
                  </button>

                  <button class="action-btn reject-btn"
                    onclick="location.href='/reject-member/<%= r.id %>'">
                    Reject
                  </button>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>

      <% } else { %>
        <p>No notifications yet.</p>
      <% } %>

    </div>

  </div>

</div>

</body>
</html>
