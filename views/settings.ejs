<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Settings</title>

<style>
body{
  margin:0;
  font-family: Arial, sans-serif;
  background:#3C3A3A;
}

.layout{
  display:flex;
  min-height:calc(100vh - 60px);
}

.sidebar-container{
  width:55px;
}

.main-content{
  flex:1;
  padding:20px;
  background:#f4f4f4;
}

/* SETTINGS MENU */
.settings-menu{
  background:#fff;
  border-radius:8px;
  overflow:hidden;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  margin-bottom:20px;
}

.settings-item{
  padding:15px;
  border-bottom:1px solid #eee;
  cursor:pointer;
  transition:0.2s;
}

.settings-item:hover{
  background:#f0f0f0;
}

/* FORM CARD */
.card{
  display:none;
  background:#fff;
  padding:20px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

.card.active{
  display:block;
}

input{
  width:100%;
  padding:8px;
  margin:6px 0;
}

button{
  padding:10px 15px;
  background:#095959;
  color:#fff;
  border:none;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- NAVBAR -->
<%- include('navbar') %>

<div class="layout">

  <!-- SIDEBAR -->
  <div class="sidebar-container">
    <% if (show_sidebar === 'sidebar') { %>
        <%- include('sidebar') %>
    <% } else { %>
        <%- include('user_sidebar') %>
    <% } %>
  </div>

  <!-- MAIN -->
  <div class="main-content">

    <h2>Settings</h2>

    <!-- SETTINGS OPTIONS -->
    <div class="settings-menu">
      <div class="settings-item" onclick="openCard('profileCard')">Update Profile</div>
      <div class="settings-item" onclick="openCard('passwordCard')">Change Password</div>
      <div class="settings-item" onclick="openCard('forgotCard')">Forgot Password</div>
    </div>


    <!-- UPDATE PROFILE -->
    <div id="profileCard" class="card">
      <h3>Update Profile</h3>

      <form action="/settings/update-profile" method="POST" enctype="multipart/form-data">

        <input type="text" name="name" placeholder="Name" value="<%= profile?.name || '' %>" required>

        <% if (session.role === "admin") { %>
        <input type="text" name="company_name" placeholder="Company Name" value="<%= profile?.company_name || '' %>">
        <% } %>

        <input type="text" name="phone" placeholder="Phone" value="<%= profile?.phone || '' %>">

        <input type="file" name="profile_pic">

        <button type="submit">Update Profile</button>
      </form>
    </div>


    <!-- CHANGE PASSWORD -->
    <div id="passwordCard" class="card">
      <h3>Change Password</h3>

      <form action="/settings/change-password" method="POST">
        <input type="password" name="old_password" placeholder="Old Password" required>
        <input type="password" name="new_password" placeholder="New Password" required>
        <button type="submit">Change Password</button>
      </form>
    </div>


    <!-- FORGOT PASSWORD -->
    <div id="forgotCard" class="card">
      <h3>Forgot Password</h3>
      <p>Contact admin to reset your password.</p>
    </div>

  </div>

</div>

<script>
function openCard(id){
  document.querySelectorAll('.card').forEach(c => c.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
</script>

</body>
</html>
